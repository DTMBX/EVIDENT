<!-- Onboarding Tour Component - Interactive first-time user guidance -->
<div
  id="onboarding-tour"
  class="onboarding-tour"
  data-tier="{{ current_user.tier.name if current_user.is_authenticated else 'FREE' }}"
  data-is-admin="{{ 'true' if current_user.is_authenticated and current_user.is_admin else 'false' }}"
  data-user-name="{{ current_user.full_name or current_user.email.split('@')[0] if current_user.is_authenticated else 'there' }}"
  style="display: none"
>
  <!-- Tour Overlay - darkens the background -->
  <div class="tour-overlay" id="tourOverlay"></div>

  <!-- Tour Spotlight - highlights the target element -->
  <div class="tour-spotlight" id="tourSpotlight"></div>

  <!-- Tour Tooltip - the popup card -->
  <div class="tour-tooltip" id="tourTooltip">
    <button class="tour-close" id="tourClose" aria-label="Close tour">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18" />
        <line x1="6" y1="6" x2="18" y2="18" />
      </svg>
    </button>

    <div class="tour-content">
      <div class="tour-step-badge" id="tourStepBadge">Step 1 of 4</div>
      <div class="tour-icon" id="tourIcon">ðŸ‘‹</div>
      <h3 class="tour-title" id="tourTitle">Welcome!</h3>
      <p class="tour-description" id="tourDescription">Let's get you started.</p>

      <div class="tour-progress">
        <div class="tour-progress-bar">
          <div class="tour-progress-fill" id="tourProgressFill"></div>
        </div>
      </div>

      <div class="tour-actions">
        <button class="btn-tour-skip" id="tourSkip">Skip Tour</button>
        <button class="btn-tour-prev" id="tourPrev" style="display: none;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6" />
          </svg>
          <span>Back</span>
        </button>
        <button class="btn-tour-next" id="tourNext">
          <span>Next</span>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6" />
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  /* ========================================
     ONBOARDING TOUR STYLES
     ======================================== */
  
  .onboarding-tour {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 99999;
    pointer-events: none;
  }

  .onboarding-tour.active {
    pointer-events: all;
  }

  /* Overlay - darkens the background without blur */
  .tour-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(10, 10, 15, 0.75);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 99998;
  }

  .onboarding-tour.active .tour-overlay {
    opacity: 1;
  }

  /* Spotlight - highlights target element */
  .tour-spotlight {
    position: fixed;
    border: 3px solid #c41e3a;
    border-radius: 12px;
    box-shadow:
      0 0 0 4px rgba(196, 30, 58, 0.3),
      0 0 20px rgba(196, 30, 58, 0.4);
    background: transparent;
    opacity: 0;
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100000;
    pointer-events: none;
  }

  .onboarding-tour.active .tour-spotlight {
    opacity: 1;
  }

  /* Tooltip Card */
  .tour-tooltip {
    position: fixed;
    background: #ffffff;
    border-radius: 16px;
    padding: 1.75rem;
    width: 360px;
    max-width: calc(100vw - 32px);
    box-shadow: 
      0 25px 50px -12px rgba(0, 0, 0, 0.35),
      0 0 0 1px rgba(0, 0, 0, 0.05);
    opacity: 0;
    transform: scale(0.95) translateY(10px);
    transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100001;
  }

  .onboarding-tour.active .tour-tooltip {
    opacity: 1;
    transform: scale(1) translateY(0);
  }

  /* Close button */
  .tour-close {
    position: absolute;
    top: 0.75rem;
    right: 0.75rem;
    background: transparent;
    border: none;
    color: #9ca3af;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 8px;
    transition: all 0.2s ease;
    line-height: 0;
  }

  .tour-close:hover {
    background: #f3f4f6;
    color: #374151;
  }

  /* Step badge */
  .tour-step-badge {
    display: inline-block;
    font-size: 0.75rem;
    font-weight: 600;
    color: #c41e3a;
    background: rgba(196, 30, 58, 0.1);
    padding: 0.35rem 0.75rem;
    border-radius: 20px;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* Icon */
  .tour-icon {
    width: 64px;
    height: 64px;
    border-radius: 16px;
    background: linear-gradient(135deg, #c41e3a 0%, #1e40af 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    margin-bottom: 1.25rem;
    font-size: 2rem;
  }

  /* Title */
  .tour-title {
    font-size: 1.375rem;
    font-weight: 700;
    color: #0a0a0f;
    margin: 0 0 0.625rem 0;
    line-height: 1.3;
  }

  /* Description */
  .tour-description {
    color: #4b5563;
    font-size: 0.9375rem;
    line-height: 1.65;
    margin: 0 0 1.25rem 0;
  }

  /* Progress bar */
  .tour-progress {
    margin-bottom: 1.25rem;
  }

  .tour-progress-bar {
    height: 4px;
    background: #e5e7eb;
    border-radius: 2px;
    overflow: hidden;
  }

  .tour-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #c41e3a 0%, #1e40af 100%);
    border-radius: 2px;
    transition: width 0.4s ease;
    width: 25%;
  }

  /* Actions row */
  .tour-actions {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
  }

  /* Skip button */
  .btn-tour-skip {
    background: transparent;
    border: none;
    color: #9ca3af;
    font-weight: 600;
    font-size: 0.8125rem;
    cursor: pointer;
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    transition: all 0.2s ease;
  }

  .btn-tour-skip:hover {
    background: #f3f4f6;
    color: #374151;
  }

  /* Prev button */
  .btn-tour-prev {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.625rem 1rem;
    background: #f3f4f6;
    color: #374151;
    border: none;
    border-radius: 10px;
    font-weight: 600;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .btn-tour-prev:hover {
    background: #e5e7eb;
  }

  /* Next button */
  .btn-tour-next {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.625rem 1.25rem;
    background: linear-gradient(135deg, #c41e3a 0%, #1e40af 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.25s ease;
    margin-left: auto;
  }

  .btn-tour-next:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 20px rgba(196, 30, 58, 0.35);
  }

  .btn-tour-next.finish {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
  }

  .btn-tour-next.finish:hover {
    box-shadow: 0 6px 20px rgba(5, 150, 105, 0.35);
  }

  /* ========================================
     RESPONSIVE SCALING
     ======================================== */

  /* Tablet */
  @media (max-width: 768px) {
    .tour-tooltip {
      width: 320px;
      padding: 1.5rem;
    }

    .tour-icon {
      width: 56px;
      height: 56px;
      font-size: 1.75rem;
    }

    .tour-title {
      font-size: 1.25rem;
    }

    .tour-description {
      font-size: 0.875rem;
    }
  }

  /* Mobile */
  @media (max-width: 480px) {
    .tour-tooltip {
      position: fixed !important;
      bottom: 16px !important;
      left: 16px !important;
      right: 16px !important;
      top: auto !important;
      width: auto !important;
      max-width: none !important;
      padding: 1.25rem;
    }

    .tour-spotlight {
      border-width: 2px;
    }

    .tour-icon {
      width: 48px;
      height: 48px;
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .tour-title {
      font-size: 1.125rem;
    }

    .tour-description {
      font-size: 0.8125rem;
      margin-bottom: 1rem;
    }

    .tour-step-badge {
      font-size: 0.6875rem;
      padding: 0.25rem 0.625rem;
    }

    .tour-actions {
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .btn-tour-skip {
      order: 3;
      width: 100%;
      text-align: center;
      margin-top: 0.5rem;
    }

    .btn-tour-prev,
    .btn-tour-next {
      flex: 1;
    }
  }

  /* Very small screens */
  @media (max-width: 360px) {
    .tour-tooltip {
      bottom: 8px !important;
      left: 8px !important;
      right: 8px !important;
      padding: 1rem;
    }
  }
</style>

<script>
(function() {
  'use strict';

  class OnboardingTour {
    constructor() {
      this.steps = [];
      this.currentStep = 0;
      this.isActive = false;
      this.elements = {};
      
      // Wait for DOM to be ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => this.init());
      } else {
        this.init();
      }
    }

    init() {
      const tourEl = document.getElementById('onboarding-tour');
      if (!tourEl) return;

      // Check if tour was already completed
      const completed = localStorage.getItem('barberx_tour_completed');
      const skipped = localStorage.getItem('barberx_tour_skipped');
      
      if (completed || skipped) {
        tourEl.remove();
        return;
      }

      // Get user context
      this.tier = tourEl.dataset.tier || 'FREE';
      this.isAdmin = tourEl.dataset.isAdmin === 'true';
      this.userName = tourEl.dataset.userName || 'there';

      // Cache DOM elements
      this.elements = {
        tour: tourEl,
        overlay: document.getElementById('tourOverlay'),
        spotlight: document.getElementById('tourSpotlight'),
        tooltip: document.getElementById('tourTooltip'),
        stepBadge: document.getElementById('tourStepBadge'),
        icon: document.getElementById('tourIcon'),
        title: document.getElementById('tourTitle'),
        description: document.getElementById('tourDescription'),
        progressFill: document.getElementById('tourProgressFill'),
        prevBtn: document.getElementById('tourPrev'),
        nextBtn: document.getElementById('tourNext'),
        skipBtn: document.getElementById('tourSkip'),
        closeBtn: document.getElementById('tourClose')
      };

      // Load tier-appropriate steps
      this.loadSteps();

      // Bind event handlers
      this.bindEvents();

      // Start tour after a moment
      setTimeout(() => this.start(), 800);
    }

    loadSteps() {
      const userName = this.userName;
      
      // Base steps for all users
      const baseSteps = [
        {
          target: null, // Welcome screen - no target
          icon: 'ðŸ‘‹',
          title: `Welcome, ${userName}!`,
          description: this.getWelcomeMessage()
        }
      ];

      // Tier-specific feature highlights
      const tierSteps = this.getTierSteps();
      
      // Common ending steps
      const endSteps = [
        {
          target: '[data-tour="help"], .help-btn, .support-link, a[href*="support"]',
          icon: 'ðŸ’¬',
          title: 'Need Help?',
          description: 'Our support team is here for you. Click here anytime to access documentation, FAQs, or contact our support team directly.'
        },
        {
          target: null, // No target for final step
          icon: 'ðŸš€',
          title: "You're All Set!",
          description: this.getCompletionMessage()
        }
      ];

      this.steps = [...baseSteps, ...tierSteps, ...endSteps];
    }

    getWelcomeMessage() {
      if (this.isAdmin) {
        return "Welcome to your Admin Dashboard! You have full access to all platform features, user management, and system controls. Let's take a quick tour of your powerful tools.";
      }
      
      switch(this.tier) {
        case 'ENTERPRISE':
          return "Welcome to BarberX Enterprise! Your organization has access to our complete legal analysis suite with unlimited processing and dedicated support. Let's explore what's available.";
        case 'PREMIUM':
          return "Welcome to BarberX Premium! You've unlocked our most advanced AI capabilities with priority processing. Let's show you how to maximize your legal workflow.";
        case 'PROFESSIONAL':
          return "Welcome to BarberX Professional! You have access to enhanced features designed for busy legal professionals. Let's get you up to speed quickly.";
        case 'STARTER':
          return "Welcome to BarberX! Your Starter plan gives you solid tools to begin analyzing cases with AI assistance. Let's explore what you can do.";
        default:
          return "Welcome to BarberX! We're excited to help you with AI-powered legal analysis. Let's take a quick tour of the platform features.";
      }
    }

    getTierSteps() {
      if (this.isAdmin) {
        return [
          {
            target: '[data-tour="dashboard"], .dashboard-link, .stats-grid, .dashboard-stats',
            icon: 'ðŸ“Š',
            title: 'Admin Dashboard',
            description: 'Monitor platform-wide statistics, user activity, and system health. Real-time metrics help you manage operations effectively.'
          },
          {
            target: '[data-tour="users"], .user-management, a[href*="admin/users"]',
            icon: 'ðŸ‘¥',
            title: 'User Management',
            description: 'Manage all users, adjust permissions, handle support tickets, and oversee account tiers from this central hub.'
          }
        ];
      }

      switch(this.tier) {
        case 'ENTERPRISE':
          return [
            {
              target: '[data-tour="dashboard"], .dashboard-link, .stats-grid',
              icon: 'ðŸ“Š',
              title: 'Enterprise Analytics',
              description: 'Your dashboard shows team-wide usage, case progress, and advanced metrics. Monitor your entire organization\'s workflow at a glance.'
            },
            {
              target: '[data-tour="upload"], .upload-btn, .evidence-upload, a[href*="upload"]',
              icon: 'ðŸ“',
              title: 'Unlimited Uploads',
              description: 'Upload BWC videos, PDFs, and documents without limits. Batch processing is available for high-volume case work.'
            }
          ];

        case 'PREMIUM':
          return [
            {
              target: '[data-tour="dashboard"], .dashboard-link, .stats-grid',
              icon: 'ðŸ“Š',
              title: 'Premium Dashboard',
              description: 'Track your monthly usage across all features. You have generous limits designed for high-volume professional use.'
            },
            {
              target: '[data-tour="upload"], .upload-btn, .evidence-upload, a[href*="upload"]',
              icon: 'ðŸ“',
              title: 'Advanced Analysis',
              description: 'Process up to 50 hours of video monthly with priority AI processing. Get detailed forensic analysis on every upload.'
            }
          ];

        case 'PROFESSIONAL':
          return [
            {
              target: '[data-tour="dashboard"], .dashboard-link, .stats-grid',
              icon: 'ðŸ“Š',
              title: 'Your Dashboard',
              description: 'Monitor your usage and case progress here. Professional tier gives you 25 hours of video processing monthly.'
            },
            {
              target: '[data-tour="upload"], .upload-btn, .evidence-upload, a[href*="upload"]',
              icon: 'ðŸ“',
              title: 'Evidence Upload',
              description: 'Upload BWC footage, PDFs, and documents. Our AI automatically extracts key facts and identifies potential violations.'
            }
          ];

        case 'STARTER':
          return [
            {
              target: '[data-tour="dashboard"], .dashboard-link, .stats-grid, .usage-meter',
              icon: 'ðŸ“Š',
              title: 'Track Your Usage',
              description: 'Your Starter plan includes 5 hours of video processing monthly. Monitor your usage here to make the most of your limits.'
            },
            {
              target: '[data-tour="upload"], .upload-btn, .evidence-upload, a[href*="upload"]',
              icon: 'ðŸ“',
              title: 'Upload Evidence',
              description: 'Upload BWC videos and documents for AI analysis. Start with your most important cases to see the power of BarberX.'
            }
          ];

        default: // FREE
          return [
            {
              target: '[data-tour="dashboard"], .dashboard-link, .stats-grid, .usage-meter',
              icon: 'ðŸ“Š',
              title: 'Your Dashboard',
              description: 'Monitor your free tier usage here. You get 2 video analyses per month to explore the platform capabilities.'
            },
            {
              target: '[data-tour="upload"], .upload-btn, .evidence-upload, a[href*="upload"]',
              icon: 'ðŸ“',
              title: 'Upload Evidence',
              description: 'Upload a BWC video or document to see our AI in action. Free tier includes basic analysis and violation detection.'
            }
          ];
      }
    }

    getCompletionMessage() {
      if (this.isAdmin) {
        return "Your Admin dashboard is ready. You have full control over the platform. Check the admin docs or contact the dev team if you need anything.";
      }

      switch(this.tier) {
        case 'ENTERPRISE':
          return "Your Enterprise account is fully configured. Your team can collaborate on cases with unlimited access. Contact your account manager for onboarding support.";
        case 'PREMIUM':
          return "Your Premium account is ready! Start uploading evidence and let our AI accelerate your legal research. Priority support is available 24/7.";
        case 'PROFESSIONAL':
          return "You're all set with Professional! Upload your first case to see BarberX in action. Check the docs for tips on maximizing your workflow.";
        case 'STARTER':
          return "Welcome aboard! Start by uploading a case file to experience AI-powered analysis. Upgrade anytime for more features and processing power.";
        default:
          return "That's the basics! Upload your first file to experience AI-powered legal analysis. Consider upgrading for more features when you're ready.";
      }
    }

    bindEvents() {
      this.elements.nextBtn.addEventListener('click', () => this.next());
      this.elements.prevBtn.addEventListener('click', () => this.prev());
      this.elements.skipBtn.addEventListener('click', () => this.skip());
      this.elements.closeBtn.addEventListener('click', () => this.skip());
      
      // Close on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && this.isActive) {
          this.skip();
        }
      });

      // Handle window resize
      let resizeTimeout;
      window.addEventListener('resize', () => {
        if (!this.isActive) return;
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => this.positionElements(), 150);
      });
    }

    start() {
      if (this.steps.length === 0) return;
      
      this.isActive = true;
      this.elements.tour.style.display = 'block';
      
      // Force reflow for animation
      void this.elements.tour.offsetWidth;
      
      this.elements.tour.classList.add('active');
      this.showStep(0);
    }

    showStep(index) {
      if (index < 0 || index >= this.steps.length) return;
      
      this.currentStep = index;
      const step = this.steps[index];
      const total = this.steps.length;

      // Update content
      this.elements.stepBadge.textContent = `Step ${index + 1} of ${total}`;
      this.elements.icon.textContent = step.icon;
      this.elements.title.textContent = step.title;
      this.elements.description.textContent = step.description;

      // Update progress bar
      const progress = ((index + 1) / total) * 100;
      this.elements.progressFill.style.width = `${progress}%`;

      // Update buttons
      this.elements.prevBtn.style.display = index > 0 ? 'flex' : 'none';
      
      if (index === total - 1) {
        this.elements.nextBtn.innerHTML = '<span>Get Started</span><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>';
        this.elements.nextBtn.classList.add('finish');
        this.elements.skipBtn.style.display = 'none';
      } else {
        this.elements.nextBtn.innerHTML = '<span>Next</span><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>';
        this.elements.nextBtn.classList.remove('finish');
        this.elements.skipBtn.style.display = 'block';
      }

      // Position elements
      this.positionElements();
    }

    positionElements() {
      const step = this.steps[this.currentStep];
      
      // Try to find target element
      let targetEl = null;
      if (step.target) {
        // Try each selector in the comma-separated list
        const selectors = step.target.split(',').map(s => s.trim());
        for (const selector of selectors) {
          try {
            targetEl = document.querySelector(selector);
            if (targetEl && this.isElementVisible(targetEl)) break;
            targetEl = null;
          } catch (e) {
            // Invalid selector, skip
          }
        }
      }

      if (targetEl && this.isElementVisible(targetEl)) {
        // Position spotlight around target
        const rect = targetEl.getBoundingClientRect();
        const padding = 10;
        
        this.elements.spotlight.style.display = 'block';
        this.elements.spotlight.style.top = `${rect.top - padding}px`;
        this.elements.spotlight.style.left = `${rect.left - padding}px`;
        this.elements.spotlight.style.width = `${rect.width + padding * 2}px`;
        this.elements.spotlight.style.height = `${rect.height + padding * 2}px`;

        // Scroll element into view if needed
        targetEl.scrollIntoView({ behavior: 'smooth', block: 'center' });

        // Position tooltip relative to target
        setTimeout(() => this.positionTooltip(rect), 50);
      } else {
        // No target - center the tooltip and hide spotlight
        this.elements.spotlight.style.display = 'none';
        this.centerTooltip();
      }
    }

    isElementVisible(el) {
      if (!el) return false;
      const rect = el.getBoundingClientRect();
      const style = window.getComputedStyle(el);
      return (
        rect.width > 0 &&
        rect.height > 0 &&
        style.display !== 'none' &&
        style.visibility !== 'hidden' &&
        style.opacity !== '0'
      );
    }

    positionTooltip(targetRect) {
      const tooltip = this.elements.tooltip;
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      const margin = 20;

      // On mobile, CSS handles positioning
      if (viewportWidth <= 480) {
        tooltip.style.top = '';
        tooltip.style.left = '';
        return;
      }

      // Get tooltip dimensions
      const tooltipRect = tooltip.getBoundingClientRect();
      let top, left;

      // Try below target first
      if (targetRect.bottom + tooltipRect.height + margin < viewportHeight) {
        top = targetRect.bottom + margin;
        left = targetRect.left + (targetRect.width / 2) - (tooltipRect.width / 2);
      }
      // Try above target
      else if (targetRect.top - tooltipRect.height - margin > 0) {
        top = targetRect.top - tooltipRect.height - margin;
        left = targetRect.left + (targetRect.width / 2) - (tooltipRect.width / 2);
      }
      // Try right of target
      else if (targetRect.right + tooltipRect.width + margin < viewportWidth) {
        top = targetRect.top + (targetRect.height / 2) - (tooltipRect.height / 2);
        left = targetRect.right + margin;
      }
      // Try left of target
      else {
        top = targetRect.top + (targetRect.height / 2) - (tooltipRect.height / 2);
        left = targetRect.left - tooltipRect.width - margin;
      }

      // Keep within viewport
      left = Math.max(margin, Math.min(left, viewportWidth - tooltipRect.width - margin));
      top = Math.max(margin, Math.min(top, viewportHeight - tooltipRect.height - margin));

      tooltip.style.top = `${top}px`;
      tooltip.style.left = `${left}px`;
    }

    centerTooltip() {
      const tooltip = this.elements.tooltip;
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;

      // On mobile, CSS handles positioning
      if (viewportWidth <= 480) {
        tooltip.style.top = '';
        tooltip.style.left = '';
        return;
      }

      // Force a layout to get accurate dimensions
      const tooltipRect = tooltip.getBoundingClientRect();
      tooltip.style.top = `${(viewportHeight - tooltipRect.height) / 2}px`;
      tooltip.style.left = `${(viewportWidth - tooltipRect.width) / 2}px`;
    }

    next() {
      if (this.currentStep < this.steps.length - 1) {
        this.showStep(this.currentStep + 1);
      } else {
        this.complete();
      }
    }

    prev() {
      if (this.currentStep > 0) {
        this.showStep(this.currentStep - 1);
      }
    }

    skip() {
      localStorage.setItem('barberx_tour_skipped', 'true');
      this.close();
    }

    complete() {
      localStorage.setItem('barberx_tour_completed', 'true');
      this.close();
    }

    close() {
      this.elements.tour.classList.remove('active');
      this.isActive = false;
      
      setTimeout(() => {
        this.elements.tour.style.display = 'none';
        this.elements.tour.remove();
      }, 350);
    }
  }

  // Initialize the tour
  new OnboardingTour();
})();
</script>
